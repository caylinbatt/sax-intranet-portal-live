<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sax Advisory Group - Internal Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo-section h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 5px;
        }

        .logo-section p {
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: linear-gradient(45deg, #3498db, #2980b9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.3em;
        }

        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 18px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-icon {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3em;
        }

        .ai-chat { background: linear-gradient(45deg, #e74c3c, #c0392b); }
        .news { background: linear-gradient(45deg, #3498db, #2980b9); }
        .social { background: linear-gradient(45deg, #9b59b6, #8e44ad); }
        .remote { background: linear-gradient(45deg, #27ae60, #229954); }
        .gamification { background: linear-gradient(45deg, #f39c12, #e67e22); }
        .departments { background: linear-gradient(45deg, #34495e, #2c3e50); }
        .staff-spotlight { background: linear-gradient(45deg, #ff6b35, #f7931e); }
        .mumbai { background: linear-gradient(45deg, #ff9a56, #ff6b35); }
        .suggestions { background: linear-gradient(45deg, #26d0ce, #1a2980); }
        .sales { background: linear-gradient(45deg, #16a085, #27ae60); }
        .content { background: linear-gradient(45deg, #8e44ad, #9b59b6); }
        .marketing { background: linear-gradient(45deg, #e67e22, #f39c12); }

        .chat-interface {
            border: 2px solid #ecf0f1;
            border-radius: 12px;
            height: 220px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            background: #3498db;
            color: white;
            padding: 12px 18px;
            border-radius: 10px 10px 0 0;
            font-weight: bold;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .chat-input {
            display: flex;
            padding: 12px;
            background: #ecf0f1;
            border-radius: 0 0 10px 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            margin-right: 10px;
            font-size: 14px;
        }

        .chat-input button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .news-item, .spotlight-item {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 6px;
        }

        .news-item h4, .spotlight-item h4 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .news-date, .spotlight-date {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .social-post {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            margin-bottom: 15px;
            border: 1px solid #ecf0f1;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 12px;
        }

        .sales-metric {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
            border-left: 4px solid #27ae60;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .sales-metric:hover {
            background: #e9ecef;
            transform: scale(1.02);
        }

        .metric-number {
            font-size: 2.2em;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }

        .metric-label {
            color: #7f8c8d;
            font-size: 0.95em;
        }

        .hubspot-deal {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .hubspot-deal:hover {
            background: #fff1b3;
            transform: translateX(5px);
        }

        .deal-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .deal-stage {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .deal-amount {
            font-weight: bold;
            color: #27ae60;
            float: right;
        }

        .gamification-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #f39c12;
            margin-bottom: 8px;
        }

        .progress-bar {
            background: #ecf0f1;
            border-radius: 10px;
            height: 10px;
            margin: 12px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            border-radius: 10px;
        }

        .department-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .dept-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #ecf0f1;
        }

        .dept-item:hover {
            background: #e9ecef;
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .remote-features {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .feature-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 18px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .feature-icon {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3em;
        }

        .suggestion-form {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }

        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-group textarea {
            height: 80px;
            resize: vertical;
        }

        .submit-btn {
            background: linear-gradient(45deg, #26d0ce, #1a2980);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
        }

        .content-categories {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .category-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #ecf0f1;
        }

        .category-item:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .marketing-request {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 12px;
        }

        .request-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }

        .status-pending { background: #fff3cd; color: #856404; }
        .status-approved { background: #d1edff; color: #004085; }
        .status-completed { background: #d4edda; color: #155724; }

        .notification-badge {
            background: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .quick-link {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            text-decoration: none;
            color: #2c3e50;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .quick-link:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
            text-decoration: none;
            color: #3498db;
        }

        .mumbai-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .mumbai-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .calendar-event {
            background: #f8f9fa;
            border-left: 4px solid #0078d4;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .calendar-event:hover {
            background: #e9ecef;
            transform: translateX(3px);
        }

        .event-time {
            font-weight: bold;
            color: #0078d4;
            font-size: 0.9em;
        }

        .event-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 4px;
        }

        .event-attendees {
            font-size: 0.8em;
            color: #7f8c8d;
        }

        .teams-chat {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            border-left: 4px solid #6264a7;
        }

        .teams-chat-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .teams-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(45deg, #6264a7, #464775);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9em;
        }

        .email-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #0078d4;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .email-item:hover {
            background: #e9ecef;
            transform: translateX(3px);
        }

        .email-sender {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 4px;
        }

        .email-subject {
            color: #495057;
            margin-bottom: 4px;
        }

        .email-time {
            font-size: 0.8em;
            color: #7f8c8d;
        }

        .unread {
            border-left-color: #e74c3c;
            background: #fff5f5;
        }

        .online-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .status-available { background-color: #27ae60; }
        .status-busy { background-color: #e74c3c; }
        .status-away { background-color: #f39c12; }
        .status-offline { background-color: #95a5a6; }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .gamification-stats, 
            .department-grid,
            .content-categories,
            .mumbai-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo-section">
                    <h1>Sax Advisory Group</h1>
                    <p>Internal Portal & Collaboration Hub</p>
                </div>
                <div class="user-info" id="userInfo">
                    <div class="user-avatar" id="userAvatar">...</div>
                    <div id="userDetails">
                        <div style="font-weight: bold;" id="userName">Loading...</div>
                        <div style="color: #7f8c8d; font-size: 0.9em;" id="userRole">Authenticating...</div>
                    </div>
                    <button onclick="logout()" style="margin-left: 15px; padding: 8px 15px; border: none; background: #e74c3c; color: white; border-radius: 5px; cursor: pointer;">Logout</button>
                </div>
            </div>
        </header>

        <div class="main-grid">
            <!-- AI Chat Section -->
            <div class="card">
                <h3>
                    <div class="card-icon ai-chat">ü§ñ</div>
                    Sax AI Assistant
                </h3>
                <div class="chat-interface">
                    <div class="chat-header">
                        AI Chat - Ready to Help with Policies, HR & More
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 6px; margin-bottom: 8px;">
                            <strong>AI:</strong> Hello! I can help with HR questions, company policies, SharePoint guidance, or connect you with the right department. What do you need help with today?
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" placeholder="Ask about policies, procedures, contacts..." id="chatInput">
                        <button onclick="sendMessage()">Send</button>
                    </div>
                </div>
            </div>

            <!-- News & Updates Section -->
            <div class="card">
                <h3>
                    <div class="card-icon news">üì∞</div>
                    Company News & Updates
                    <div class="notification-badge">5</div>
                </h3>
                <div class="news-item">
                    <h4>SharePoint Intranet Launch Timeline</h4>
                    <p>Beta testing phase complete! Full rollout scheduled for Q1 2026.</p>
                    <div class="news-date">Today, 9:45 AM</div>
                </div>
                <div class="news-item">
                    <h4>New HubSpot Integration Live</h4>
                    <p>Sales dashboard now shows real-time prospect and win data.</p>
                    <div class="news-date">Yesterday, 2:15 PM</div>
                </div>
                <div class="news-item">
                    <h4>Q4 All-Hands Meeting - Dec 15th</h4>
                    <p>Join us for quarterly updates, team celebrations, and 2026 vision.</p>
                    <div class="news-date">2 days ago</div>
                </div>
            </div>

            <!-- Sales Dashboard -->
            <div class="card">
                <h3>
                    <div class="card-icon sales">üìà</div>
                    Sales Dashboard (HubSpot)
                </h3>
                <div class="sales-metric">
                    <div class="metric-number">$2.4M</div>
                    <div class="metric-label">Q4 New Wins</div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                    <div class="sales-metric">
                        <div class="metric-number">12</div>
                        <div class="metric-label">Active Prospects</div>
                    </div>
                    <div class="sales-metric">
                        <div class="metric-number">8</div>
                        <div class="metric-label">Deals Closed</div>
                    </div>
                </div>
                <div id="recentDeals">
                    <h4 style="margin: 15px 0 10px 0;">Recent Deals:</h4>
                    <div class="hubspot-deal" onclick="openDeal('TechCorp Manufacturing')">
                        <div class="deal-title">TechCorp Manufacturing <span class="deal-amount">$450K</span></div>
                        <div class="deal-stage">Closed Won ‚Ä¢ Close: Sep 15, 2025</div>
                    </div>
                    <div class="hubspot-deal" onclick="openDeal('GreenEnergy Solutions')">
                        <div class="deal-title">GreenEnergy Solutions <span class="deal-amount">$275K</span></div>
                        <div class="deal-stage">Proposal Sent ‚Ä¢ Close: Oct 30, 2025</div>
                    </div>
                    <div class="hubspot-deal" onclick="openDeal('DataViz Analytics')">
                        <div class="deal-title">DataViz Analytics <span class="deal-amount">$125K</span></div>
                        <div class="deal-stage">Discovery ‚Ä¢ Close: Nov 15, 2025</div>
                    </div>
                </div>
            </div>

            <!-- Staff Spotlight -->
            <div class="card">
                <h3>
                    <div class="card-icon staff-spotlight">‚≠ê</div>
                    Staff Spotlight
                </h3>
                <div class="spotlight-item">
                    <h4>Employee of the Month: Sarah Chen</h4>
                    <p>Tax Planning Department - Outstanding client service and innovative process improvements that saved 15+ hours weekly.</p>
                    <div class="spotlight-date">December 2025</div>
                </div>
                <div class="spotlight-item">
                    <h4>New Hire Spotlight: Mike Rodriguez</h4>
                    <p>Joining our Wealth Advisory team with 8 years experience in portfolio management from Goldman Sachs.</p>
                    <div class="spotlight-date">This week</div>
                </div>
                <div style="margin-top: 15px; text-align: center; padding: 15px; background: #fff3cd; border-radius: 8px;">
                    <strong>Nominate a colleague</strong> for next month's spotlight! 
                    <a href="#" onclick="submitNomination()" style="color: #f39c12;">Submit nomination ‚Üí</a>
                </div>
            </div>

            <!-- Mumbai Office Section -->
            <div class="card">
                <h3>
                    <div class="card-icon mumbai">üè¢</div>
                    Sax Mumbai Office
                </h3>
                <div class="mumbai-stats">
                    <div class="mumbai-item">
                        <div style="font-size: 1.8em; font-weight: bold; color: #ff6b35;">25</div>
                        <div>Team Members</div>
                    </div>
                    <div class="mumbai-item">
                        <div style="font-size: 1.8em; font-weight: bold; color: #ff6b35;">6</div>
                        <div>Departments</div>
                    </div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                    <strong>Mumbai Update:</strong> New office expansion complete! Welcome to 15 new team members joining in January 2026.
                </div>
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                    <strong>Time in Mumbai:</strong> <span id="mumbaiTime"></span><br>
                    <strong>Next All-Office Call:</strong> Friday 10:30 AM EST / 9:00 PM IST
                </div>
            </div>

            <!-- Tech & Wealth Advisory Departments -->
            <div class="card">
                <h3>
                    <div class="card-icon departments">üè¢</div>
                    Tech & Wealth Advisory
                </h3>
                <div class="department-grid">
                    <div class="dept-item" onclick="showDepartment('Technology Advisory')">
                        <strong>Technology Advisory</strong><br>
                        <small>12 members ‚Ä¢ Digital Transformation</small><br>
                        <div style="margin-top: 8px; color: #27ae60;">‚úì 3 Active Projects</div>
                    </div>
                    <div class="dept-item" onclick="showDepartment('Wealth Management')">
                        <strong>Wealth Management</strong><br>
                        <small>18 members ‚Ä¢ Portfolio Advisory</small><br>
                        <div style="margin-top: 8px; color: #27ae60;">‚úì $45M Assets Under Management</div>
                    </div>
                    <div class="dept-item" onclick="showDepartment('Tax Planning')">
                        <strong>Tax Planning</strong><br>
                        <small>8 members ‚Ä¢ Tax Strategy</small><br>
                        <div style="margin-top: 8px; color: #f39c12;">‚Üí Busy Season Prep</div>
                    </div>
                    <div class="dept-item" onclick="showDepartment('Business Development')">
                        <strong>Business Development</strong><br>
                        <small>6 members ‚Ä¢ Client Acquisition</small><br>
                        <div style="margin-top: 8px; color: #e74c3c;">üî• Q4 Push Active</div>
                    </div>
                </div>
            </div>

            <!-- Content & Branding Hub -->
            <div class="card">
                <h3>
                    <div class="card-icon content">üìÅ</div>
                    Content & Brand Assets
                </h3>
                <div class="content-categories">
                    <div class="category-item" onclick="openCategory('Presentations')">
                        <strong>üìä Presentations</strong><br>
                        <small>Client decks, proposals, templates</small>
                    </div>
                    <div class="category-item" onclick="openCategory('Brand Guidelines')">
                        <strong>üé® Brand Guidelines</strong><br>
                        <small>Logos, colors, typography</small>
                    </div>
                    <div class="category-item" onclick="openCategory('Collateral')">
                        <strong>üìÑ Collateral</strong><br>
                        <small>Brochures, one-pagers, case studies</small>
                    </div>
                    <div class="category-item" onclick="openCategory('Media Assets')">
                        <strong>üì∏ Media Assets</strong><br>
                        <small>Photos, videos, social content</small>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 12px; background: #f0f4ff; border-radius: 8px; text-align: center;">
                    <strong>Need something custom?</strong> Submit a marketing request below! üìù
                </div>
            </div>

            <!-- Marketing Requests -->
            <div class="card">
                <h3>
                    <div class="card-icon marketing">üìù</div>
                    Marketing Requests
                    <div class="notification-badge">2</div>
                </h3>
                <div class="marketing-request">
                    <strong>Trade Show Booth Design</strong>
                    <span class="request-status status-pending">Pending</span>
                    <div style="margin-top: 8px; font-size: 0.9em; color: #666;">
                        For Financial Planning Expo 2026 - Need graphics and giveaways
                    </div>
                </div>
                <div class="marketing-request">
                    <strong>Client Holiday Gifts</strong>
                    <span class="request-status status-approved">Approved</span>
                    <div style="margin-top: 8px; font-size: 0.9em; color: #666;">
                        Premium branded items for top 20 clients
                    </div>
                </div>
                <button class="submit-btn" onclick="openRequestForm()" style="margin-top: 15px;">
                    + New Marketing Request
                </button>
            </div>

            <!-- Social Feed Section -->
            <div class="card">
                <h3>
                    <div class="card-icon social">üí¨</div>
                    Team Social Feed
                </h3>
                <div class="social-post">
                    <div class="post-header">
                        <div class="post-avatar">JS</div>
                        <div>
                            <div style="font-weight: bold;">John Smith</div>
                            <div style="font-size: 0.9em; color: #7f8c8d;">Senior Advisor</div>
                        </div>
                    </div>
                    <p>Just closed the TechCorp deal! Amazing collaboration between our Mumbai and NYC teams. This is what global teamwork looks like! üåçüéâ</p>
                </div>
                <div class="social-post">
                    <div class="post-header">
                        <div class="post-avatar">SC</div>
                        <div>
                            <div style="font-weight: bold;">Sarah Chen</div>
                            <div style="font-size: 0.9em; color: #7f8c8d;">Tax Planning</div>
                        </div>
                    </div>
                    <p>Thank you for the Employee of the Month recognition! Couldn't have done it without my amazing team. Let's keep innovating! üèÜ</p>
                </div>
            </div>

            <!-- Gamification Section -->
            <div class="card">
                <h3>
                    <div class="card-icon gamification">üèÜ</div>
                    Your Progress & Achievements
                </h3>
                <div class="gamification-stats">
                    <div class="stat-item">
                        <div class="stat-number">2,340</div>
                        <div>Points Earned</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">#8</div>
                        <div>Team Ranking</div>
                    </div>
                </div>
                <div style="margin-top: 15px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>Level 4 Progress</span>
                        <span>85%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 85%;"></div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 12px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #f39c12;">
                    <strong>Next Achievement:</strong> "Intranet Pioneer" - Complete SharePoint migration project üöÄ
                </div>
            </div>

            <!-- Remote Employee Hub -->
            <div class="card">
                <h3>
                    <div class="card-icon remote">üè†</div>
                    Remote Employee Hub
                </h3>
                <div class="remote-features">
                    <div class="feature-item">
                        <div class="feature-icon">üìπ</div>
                        <div>
                            <strong>Virtual Coffee Chat</strong><br>
                            <small>Tomorrow 3 PM EST ‚Ä¢ 15 attendees signed up</small>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üéØ</div>
                        <div>
                            <strong>Daily Stand-up</strong><br>
                            <small>Share goals, blockers, and wins</small>
                        </div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üë•</div>
                        <div>
                            <strong>Buddy System</strong><br>
                            <small>Your buddy: Sarah Chen (Tax) ‚Ä¢ Mumbai buddy: Priya Sharma</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Outlook Calendar -->
            <div class="card">
                <h3>
                    <div class="card-icon" style="background: linear-gradient(45deg, #0078d4, #005a9e);">üìÖ</div>
                    My Outlook Calendar
                </h3>
                <div id="calendarContent">
                    <div style="text-align: center; padding: 20px; color: #666;">Loading your calendar...</div>
                </div>
            </div>

            <!-- Teams Activity -->
            <div class="card">
                <h3>
                    <div class="card-icon" style="background: linear-gradient(45deg, #6264a7, #464775);">üí¨</div>
                    Teams Activity
                    <div class="notification-badge" id="teamsNotificationBadge">0</div>
                </h3>
                <div id="teamsContent">
                    <div style="text-align: center; padding: 20px; color: #666;">Loading Teams data...</div>
                </div>
            </div>

            <!-- Outlook Email Summary -->
            <div class="card">
                <h3>
                    <div class="card-icon" style="background: linear-gradient(45deg, #0078d4, #005a9e);">üìß</div>
                    Outlook Email Summary
                    <div class="notification-badge" id="emailNotificationBadge">0</div>
                </h3>
                <div id="emailContent">
                    <div style="text-align: center; padding: 20px; color: #666;">Loading email summary...</div>
                </div>
            </div>

            <!-- Site Suggestions -->
            <div class="card">
                <h3>
                    <div class="card-icon suggestions">üí°</div>
                    Suggest Improvements
                </h3>
                <div class="suggestion-form">
                    <div class="form-group">
                        <label for="suggestionType">Suggestion Type</label>
                        <select id="suggestionType">
                            <option value="feature">New Feature Request</option>
                            <option value="improvement">Existing Feature Improvement</option>
                            <option value="bug">Bug Report</option>
                            <option value="content">Content Request</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="suggestionText">Your Suggestion</label>
                        <textarea id="suggestionText" placeholder="Describe your idea or issue..."></textarea>
                    </div>
                    <button class="submit-btn" onclick="submitSuggestion()">
                        Submit Suggestion
                    </button>
                </div>
                <div style="margin-top: 15px; padding: 10px; background: #d4edda; border-radius: 6px; font-size: 0.9em;">
                    <strong>Recent implementation:</strong> Added Mumbai time zone display (suggested by Remote team)
                </div>
            </div>
        </div>

        <!-- Quick Links Section -->
        <div class="quick-links">
            <a href="#" class="quick-link" onclick="openLink('SharePoint Training')">
                <div style="font-size: 2.2em; margin-bottom: 12px;">üìä</div>
                <strong>SharePoint Training</strong><br>
                <small>Learn the new intranet features and best practices</small>
            </a>
            <a href="#" class="quick-link" onclick="openLink('Professional Development')">
                <div style="font-size: 2.2em; margin-bottom: 12px;">üéì</div>
                <strong>Professional Development</strong><br>
                <small>Training resources and certification programs</small>
            </a>
            <a href="#" class="quick-link" onclick="openLink('IT Support')">
                <div style="font-size: 2.2em; margin-bottom: 12px;">üé´</div>
                <strong>IT Support Portal</strong><br>
                <small>Submit tickets and access technical resources</small>
            </a>
            <a href="#" class="quick-link" onclick="openLink('Directory')">
                <div style="font-size: 2.2em; margin-bottom: 12px;">üìû</div>
                <strong>Global Directory</strong><br>
                <small>Find colleagues across NYC, Mumbai, and remote</small>
            </a>
            <a href="#" class="quick-link" onclick="openLink('Client Portal')">
                <div style="font-size: 2.2em; margin-bottom: 12px;">üíº</div>
                <strong>Client Portal Access</strong><br>
                <small>Secure client collaboration and document sharing</small>
            </a>
            <a href="#" class="quick-link" onclick="openLink('Business Intelligence')">
                <div style="font-size: 2.2em; margin-bottom: 12px;">üìà</div>
                <strong>Business Intelligence</strong><br>
                <small>Analytics, reports, and performance dashboards</small>
            </a>
        </div>
    </div>

    <script>
        // Authentication and user management
        async function loadUserInfo() {
            try {
                const response = await fetch('/.auth/me');
                const payload = await response.json();
                
                if (payload.clientPrincipal) {
                    const user = payload.clientPrincipal;
                    const userName = user.userDetails || user.userId;
                    const initials = userName.split(/[\s@]+/).map(n => n[0]).join('').toUpperCase().substring(0, 2);
                    
                    document.getElementById('userName').textContent = userName;
                    document.getElementById('userAvatar').textContent = initials;
                    document.getElementById('userRole').textContent = 'Authenticated User ‚Ä¢ ' + (user.identityProvider || 'Microsoft 365');
                } else {
                    // Redirect to login if not authenticated
                    window.location.href = '/.auth/login/aad';
                }
            } catch (error) {
                console.log('Authentication check failed:', error);
                // Redirect to login on error
                window.location.href = '/.auth/login/aad';
            }
        }
        
        function logout() {
            window.location.href = '/.auth/logout';
        }
        
        // Microsoft Graph API integration
        async function getAccessToken() {
            try {
                const response = await fetch('/.auth/me');
                const payload = await response.json();
                return payload.clientPrincipal?.accessToken;
            } catch (error) {
                console.error('Error getting access token:', error);
                return null;
            }
        }

        async function callGraphAPI(endpoint) {
            const token = await getAccessToken();
            if (!token) {
                console.log('No access token available');
                return null;
            }

            try {
                const response = await fetch(`https://graph.microsoft.com/v1.0${endpoint}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    return await response.json();
                } else {
                    console.error('Graph API call failed:', response.status, response.statusText);
                    return null;
                }
            } catch (error) {
                console.error('Error calling Graph API:', error);
                return null;
            }
        }

        async function loadCalendarEvents() {
            const calendarData = await callGraphAPI('/me/calendar/events?$top=5&$orderby=start/dateTime&$filter=start/dateTime ge ' + new Date().toISOString());
            const calendarContent = document.getElementById('calendarContent');
            
            if (calendarData && calendarData.value && calendarData.value.length > 0) {
                const eventsHTML = calendarData.value.map(event => {
                    const startTime = new Date(event.start.dateTime).toLocaleString('en-US', {
                        weekday: 'short',
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit'
                    });
                    const attendeeCount = event.attendees ? event.attendees.length : 0;
                    
                    return `
                        <div class="calendar-event">
                            <div class="event-time">${startTime}</div>
                            <div class="event-title">${event.subject}</div>
                            ${event.location?.displayName ? `<div style="font-size: 0.8em; color: #666;">üìç ${event.location.displayName}</div>` : ''}
                            ${attendeeCount > 0 ? `<div class="event-attendees">${attendeeCount} attendee${attendeeCount > 1 ? 's' : ''}</div>` : ''}
                        </div>
                    `;
                }).join('');
                
                calendarContent.innerHTML = eventsHTML;
            } else {
                calendarContent.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">No upcoming events found</div>';
            }
        }

        async function loadEmailSummary() {
            const emailData = await callGraphAPI('/me/mailFolders/inbox/messages?$top=5&$orderby=receivedDateTime desc&$select=subject,sender,receivedDateTime,isRead');
            const emailContent = document.getElementById('emailContent');
            const emailBadge = document.getElementById('emailNotificationBadge');
            
            if (emailData && emailData.value && emailData.value.length > 0) {
                const unreadCount = emailData.value.filter(email => !email.isRead).length;
                emailBadge.textContent = unreadCount;
                emailBadge.style.display = unreadCount > 0 ? 'flex' : 'none';
                
                const emailsHTML = emailData.value.map(email => {
                    const receivedTime = new Date(email.receivedDateTime).toLocaleString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit'
                    });
                    
                    return `
                        <div class="email-item ${!email.isRead ? 'unread' : ''}">
                            <div class="email-sender">${email.sender.emailAddress.name || email.sender.emailAddress.address}</div>
                            <div class="email-subject">${email.subject}</div>
                            <div class="email-time">${receivedTime}</div>
                        </div>
                    `;
                }).join('');
                
                emailContent.innerHTML = emailsHTML;
            } else {
                emailContent.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">No recent emails found</div>';
                emailBadge.style.display = 'none';
            }
        }

        async function loadTeamsActivity() {
            // Note: Teams chat API requires additional permissions and may not be available in all tenants
            const teamsContent = document.getElementById('teamsContent');
            const teamsBadge = document.getElementById('teamsNotificationBadge');
            
            // For now, show a placeholder with presence information
            const presenceData = await callGraphAPI('/me/presence');
            
            if (presenceData) {
                const statusClass = `status-${presenceData.availability.toLowerCase()}`;
                const activity = presenceData.activity || presenceData.availability;
                
                teamsContent.innerHTML = `
                    <div class="teams-chat">
                        <div class="teams-chat-header">
                            <div class="teams-avatar">ME</div>
                            <div>
                                <div style="font-weight: bold;">Your Status</div>
                                <div style="font-size: 0.9em; color: #666;">
                                    <span class="online-status ${statusClass}"></span>
                                    ${activity.charAt(0).toUpperCase() + activity.slice(1)}
                                </div>
                            </div>
                        </div>
                        <div style="font-size: 0.9em; color: #666; margin-top: 8px;">
                            Teams integration active. Full chat history requires additional permissions.
                        </div>
                    </div>
                `;
                teamsBadge.style.display = 'none';
            } else {
                teamsContent.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">Teams data not available</div>';
                teamsBadge.style.display = 'none';
            }
        }

        async function loadOffice365Data() {
            // Load all Office 365 integrations
            await Promise.all([
                loadCalendarEvents(),
                loadEmailSummary(),
                loadTeamsActivity()
            ]);
        }

        // Load user info and Office 365 data on page load
        document.addEventListener('DOMContentLoaded', async () => {
            await loadUserInfo();
            await loadOffice365Data();
            
            // Refresh Office 365 data every 5 minutes
            setInterval(loadOffice365Data, 300000);
        });
        
        // Chat functionality
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const messages = document.getElementById('chatMessages');
            
            if (input.value.trim()) {
                const userMessage = document.createElement('div');
                userMessage.style.cssText = 'background: #f0f0f0; padding: 10px; border-radius: 6px; margin-bottom: 8px; text-align: right;';
                userMessage.innerHTML = `<strong>You:</strong> ${input.value}`;
                messages.appendChild(userMessage);
                
                setTimeout(() => {
                    const aiMessage = document.createElement('div');
                    aiMessage.style.cssText = 'background: #e3f2fd; padding: 10px; border-radius: 6px; margin-bottom: 8px;';
                    
                    const responses = [
                        "For SharePoint questions, I recommend checking our training resources in the quick links section.",
                        "I can help you find the right department contact. Try the Global Directory for specific team members.",
                        "For IT issues, please submit a ticket through the IT Support Portal. I can also help with basic troubleshooting.",
                        "Looking for company policies? Check the content hub or contact HR directly for specific guidance.",
                        "Need help with HubSpot or sales data? The sales dashboard shows real-time metrics, or contact the Business Development team.",
                        "For marketing requests, use the Marketing Requests section above to submit collateral or event needs."
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    aiMessage.innerHTML = `<strong>AI:</strong> ${randomResponse}`;
                    messages.appendChild(aiMessage);
                    
                    messages.scrollTop = messages.scrollHeight;
                }, 1200);
                
                input.value = '';
                messages.scrollTop = messages.scrollHeight;
            }
        }

        // Enter key support for chat
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Mumbai time display
        function updateMumbaiTime() {
            const mumbaiTime = new Date().toLocaleString("en-US", {timeZone: "Asia/Kolkata"});
            document.getElementById('mumbaiTime').textContent = mumbaiTime;
        }
        updateMumbaiTime();
        setInterval(updateMumbaiTime, 60000);

        // Interactive functions
        function openDeal(dealName) {
            alert(`Opening ${dealName} in HubSpot dashboard...\n\nThis would normally redirect to your HubSpot deal record with full details, timeline, and contact information.`);
        }

        function showDepartment(deptName) {
            alert(`${deptName} Department\n\nClick to view:\n‚Ä¢ Team members and contacts\n‚Ä¢ Current projects and initiatives\n‚Ä¢ Department resources and tools\n‚Ä¢ Performance metrics`);
        }

        function openCategory(category) {
            alert(`${category}\n\nBrowse and download:\n‚Ä¢ Latest templates and resources\n‚Ä¢ Brand-compliant materials\n‚Ä¢ Customizable presentations\n‚Ä¢ SharePoint integration available`);
        }

        function submitNomination() {
            const nominee = prompt('Who would you like to nominate for Staff Spotlight?\n\nEnter their name:');
            if (nominee) {
                alert(`Thank you for nominating ${nominee}!\n\nYour nomination has been submitted to HR for review. They'll be contacted for an interview if selected.`);
            }
        }

        function submitSuggestion() {
            const type = document.getElementById('suggestionType').value;
            const text = document.getElementById('suggestionText').value;
            
            if (text.trim()) {
                alert(`Thank you for your ${type} suggestion!\n\nYour feedback: "${text.substring(0, 100)}${text.length > 100 ? '...' : ''}"\n\nThis will be reviewed by the intranet development team and you'll receive updates via email.`);
                document.getElementById('suggestionText').value = '';
            } else {
                alert('Please enter your suggestion before submitting.');
            }
        }

        function openRequestForm() {
            const requestType = prompt(`Marketing Request Type:
            
1. Event Collateral (brochures, banners, giveaways)
2. Digital Assets (social media, web graphics)
3. Branded Merchandise (gifts, promotional items)
4. Presentation Templates
5. Other

Enter 1-5 or describe your need:`);
            
            if (requestType) {
                const details = prompt('Please describe your request in detail (deadline, quantities, specifications):');
                if (details) {
                    alert(`Marketing request submitted successfully!
                    
Request type: ${requestType}
Details: ${details.substring(0, 100)}${details.length > 100 ? '...' : ''}

You'll receive confirmation via email and updates on timeline. Typical turnaround is 5-10 business days depending on complexity.`);
                }
            }
        }

        function openLink(linkName) {
            alert(`Opening ${linkName}...\n\nThis would normally redirect to the appropriate SharePoint site, application, or resource portal.`);
        }

        // Notification system
        let notificationCount = 5;
        setInterval(() => {
            if (Math.random() < 0.2) {
                const badges = document.querySelectorAll('.notification-badge');
                badges.forEach(badge => {
                    if (badge.textContent !== '2') {
                        badge.textContent = Math.floor(Math.random() * 8) + 1;
                    }
                });
            }
        }, 45000);
    </script>
</body>
</html>